# 练习实例41

## 题目

学习 static 定义静态变量的用法。


## 分析

如果希望函数中的局部变量的值在函数调用结束后不消失而保留原值，这时就应该指定局部变量为“静态局部变量”，用关键字`static`进行声明。

关于静态局部变量的说明：

- 静态局部变量属于静态存储类别，在静态存储区内分配存储单元。在程序整个运行期间都不释放。而自动变量（即动态局部变量）属于动态存储类别，占动态存储空间，函数调用结束后即释放。
- 静态局部变量在编译时赋初值，即只赋初值一次；而对自动变量赋初值是在函数调用时进行，每调用一次函数重新给一次初值，相当于执行一次赋值语句。
- 如果在定义局部变量时不赋初值的话，则对静态局部变量来说，编译时自动赋初值0（对数值型变量）或空字符（对字符变量）。而对自动变量来说，如果不赋初值则它的值是一个不确定的值。
- 无论是静态局部变量（使用`static`关键字声明）还是动态局部变量（使用`auto`关键字声明）都是针对函数来说的，都属于局部变量范畴。

## 代码

```c
#include <stdio.h>

int fun(int a) {
    int b = 0;
    static int c = 3;// 可以发现使用static声明的变量在函数调用结束后也不会消失，值仍然保留着
    b += 1;
    c += 1;

    printf("a=%d b=%d c=%d\n", a, b, c);

    return a + b + c;
}

int main() {
    for (int i = 0; i < 3; i++) {
        printf("%d\n", fun(2));
    }
}
```

代码执行结果如下：

```text
a=2 b=1 c=4
7
a=2 b=1 c=5
8
a=2 b=1 c=6
9
```